(this["webpackJsonpemoji-minesweeper--react"]=this["webpackJsonpemoji-minesweeper--react"]||[]).push([[0],{15:function(e,t,a){e.exports=a(24)},20:function(e,t,a){},21:function(e,t,a){},22:function(e,t,a){},23:function(e,t,a){},24:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),i=a(11),s=a.n(i),r=(a(20),a(21),a(4)),c=a(1),u=a(5),l=a(6),m=a(8),d=a(7),h=a(9),p=a(2);function b(e,t,a){e=Math.floor(e),t=Math.floor(t),a=Math.floor(a);var n=e*t;if(e<=0||t<=0||a<=0||a>n)throw new Error("invalid game params");return{rowNum:e,colNum:t,bombNum:a,totalNum:n,blockMap:void 0,flippedNum:0,markedNum:0,stepNum:0,time:0,status:"ongoing"}}function v(e){for(var t=e.rowNum,a=e.colNum,n=function(e){for(var t=e.colNum,a=e.bombNum,n=e.totalNum,o=e.seedRow,i=e.seedCol,s=[],r=0;r<n;++r)r<a?s.push(!0):s.push(!1);for(var c=0;c<n;++c){var u=Math.floor(Math.random()*(n-1)),l=s[c];s[c]=s[u],s[u]=l}for(var m=o*t+i,d=m;d!==m-1;++d){if(!s[d])return s[d]=!0,s[m]=!1,s;d>=n-1&&(d=-1)}return s}(e),o=[],i=0;i<t;++i)for(var s=0;s<a;++s){var r=i*a+s;if(n[r])o[r]={type:-1,isMarked:!1,isFlipped:!1};else{var c=0;i>0&&s>0&&(c+=n[(i-1)*a+s-1]?1:0),i>0&&(c+=n[(i-1)*a+s]?1:0),i>0&&s<a-1&&(c+=n[(i-1)*a+s+1]?1:0),s>0&&(c+=n[i*a+s-1]?1:0),s<a-1&&(c+=n[i*a+s+1]?1:0),i<t-1&&s>0&&(c+=n[(i+1)*a+s-1]?1:0),i<t-1&&(c+=n[(i+1)*a+s]?1:0),i<t-1&&s<a-1&&(c+=n[(i+1)*a+s+1]?1:0),o[r]={type:c,isMarked:!1,isFlipped:!1}}}return o}var k=function(){},f=Object(p.a)({onClick:k}),_=Object(p.b)(f),N=function(e){var t=_(e),a=t.classBlock,n=t.ongoing,i=t.completed,s=t.failed,r=t.frightened,c=t.hovered,u=t.status,l=t.isFrightened,m=t.onClick,d="";return"completed"===u?d=i:"failed"===u?d=s:(d=n,l&&(d=r)),o.a.createElement("div",{className:"".concat(a,"__header"),onClick:m},o.a.createElement("span",{className:"".concat(a,"__status")},d),o.a.createElement("span",{className:"".concat(a,"__status ").concat(a,"__status--hovered")},c))};N.defaultProps=f;var M=N,g=a(3),w=a(14),j=a(12),O=(a(22),Object(p.a)({classBlock:"ric-checkbox",defaultChecked:!1,indeterminate:!1})),E=Object(p.c)(O),y=function(e){var t,a=E(e),i=a.id,s=a.className,r=a.classBlock,u=a.style,l=a.role,m=a.name,d=a.defaultChecked,h=a.checked,p=a.indeterminate,b=a.disabled,v=a.autoFocus,k=a.inputRef,f=a.children,_=a.onChange,N=a.onClick,M=a.onFocus,O=a.onBlur,y=Object(n.useState)(!!p||("boolean"===typeof h?h:d)),F=Object(w.a)(y,2),T=F[0],B=F[1],S=!!p||("boolean"===typeof h?h:T),C=Object(j.a)(s||"","".concat(r),(t={},Object(g.a)(t,"".concat(r,"--checked"),S),Object(g.a)(t,"".concat(r,"--indeterminate"),p),Object(g.a)(t,"".concat(r,"--disabled"),!!b),t)).join(" ");return o.a.createElement("span",{className:C,style:u},o.a.createElement("input",{ref:k,id:i,className:"".concat(r,"__input"),name:m,type:"checkbox",checked:S,disabled:b,autoFocus:v,role:l,onChange:function(t){b||("boolean"!==typeof h&&B(t.target.checked),_&&_({target:Object(c.a)({},E(e),{checked:t.target.checked}),nativeEvent:t.nativeEvent,stopPropagation:function(){t.stopPropagation()},preventDefault:function(){t.preventDefault()}}))},onClick:N,onFocus:M,onBlur:O}),o.a.createElement("span",{className:"".concat(r,"__inner")},f))};y.defaultProps=O;var F=y,T=Object(p.a)({isMarked:!1,isFlipped:!1}),B=Object(p.b)(T),S=function(e){var t=B(e),a=t.classBlock,n=t.isFlipped,i=t.isMarked,s=t.back,r=t.front,c=t.mark,u=t.onMouseUp,l=t.onContextMenu,m=t.onMouseEnter,d=t.onMouseLeave;return o.a.createElement("span",{className:"".concat(a,"__block"),onMouseUp:u,onContextMenu:l,onMouseEnter:m,onMouseLeave:d},o.a.createElement(F,{classBlock:"".concat(a,"__checkbox"),indeterminate:i,checked:n},i?c:n?r:s))};S.defaultProps=T;var C=S,x=Object(p.a)({onMouseUp:k,onContextMenu:k,onMouseEnter:k,onMouseLeave:k}),P=Object(p.b)(x),U=["","1\ufe0f\u20e3","2\ufe0f\u20e3","3\ufe0f\u20e3","4\ufe0f\u20e3","5\ufe0f\u20e3","6\ufe0f\u20e3","7\ufe0f\u20e3","8\ufe0f\u20e3"],L=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){for(var e,t=this.innerProps,a=t.classBlock,n=t.back,i=t.blank,s=t.mark,r=t.bomb,u=t.boom,l=t.rowNum,m=t.colNum,d=t.status,h=t.blockMap,p=t.onMouseUp,b=t.onContextMenu,v=t.onMouseEnter,k=t.onMouseLeave,f=Object(c.a)({},U,(e={},Object(g.a)(e,-2,u),Object(g.a)(e,-1,r),Object(g.a)(e,0,i),e)),_=[],N=0;N<=l-1;++N){for(var M=[],w=0;w<=m-1;++w)if(h){var j=h[N*m+w];"ongoing"!==d&&(j.isFlipped=!0,"completed"===d?-1===j.type&&(j.isMarked=!0):j.isMarked=!1),M.push(o.a.createElement(C,{key:"".concat(N,"-").concat(w),classBlock:a,back:n,front:f[j.type],mark:s,isMarked:j.isMarked,isFlipped:j.isFlipped,onMouseUp:p.bind(void 0,N,w),onContextMenu:b.bind(void 0,N,w),onMouseEnter:v.bind(void 0,N,w),onMouseLeave:k.bind(void 0,N,w)}))}else M.push(o.a.createElement(C,{key:"".concat(N,"-").concat(w),classBlock:a,back:n,front:n,mark:s,isMarked:!1,isFlipped:!1,onMouseUp:p.bind(void 0,N,w),onMouseEnter:v.bind(void 0,N,w),onMouseLeave:k.bind(void 0,N,w)}));_.push(o.a.createElement("div",{key:"".concat(N),className:"".concat(a,"__row")},M))}return o.a.createElement("div",{className:"".concat(a,"__grid")},_)}},{key:"innerProps",get:function(){return P(this.props)}}]),t}(n.PureComponent);L.defaultProps=x;var D=function(e){function t(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(u.a)(this,t),(e=Object(m.a)(this,Object(d.a)(t).call(this)))._interval=64,e._maxTime=void 0,e._time=0,e._timeFlags=[],e._startTime=0,e._restartTime=0,e._endTime=0,e._timeBase=0,e._status="stopped",e._resolve=void 0,e._timeout=void 0,e._tick=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if("ticking"===e._status){var a=Date.now(),n=e._timeBase+a-e._restartTime;t&&e._timeFlags.push(n),e.emit("tick",{time:n,timeFlags:Object(r.a)(e._timeFlags),startTime:e._startTime}),e._time=n,e._endTime=a,e._maxTime&&n>=e._maxTime&&e.stop()}},a.interval&&(e.interval=a.interval),e}return Object(h.a)(t,e),Object(l.a)(t,[{key:"start",value:function(e){var t=this;if("stopped"!==this._status)return Promise.reject({message:"stopwatch should start when stopped"});e&&(this.interval=e);var a=Date.now();return this._time=0,this._timeFlags=[],this._startTime=a,this._restartTime=a,this._endTime=a,this._timeBase=0,this._timeout=setInterval(this._tick,this._interval),this._setStatus("ticking"),new Promise((function(e,a){t._resolve=e}))}},{key:"stop",value:function(){"stopped"!==this._status&&(void 0!==this._timeout&&(clearInterval(this._timeout),this._timeout=void 0),this._resolve&&(this._resolve({time:this._time,timeFlags:[].concat(Object(r.a)(this._timeFlags),[this._time]),startTime:this._startTime,endTime:this._endTime,isOvertime:!!(this._maxTime&&this._time>=this._maxTime)}),this._resolve=void 0),this._time=0,this._timeFlags=[],this._startTime=0,this._restartTime=0,this._endTime=0,this._timeBase=0,this._setStatus("stopped"))}},{key:"pause",value:function(){"ticking"===this._status&&(void 0!==this._timeout&&(clearInterval(this._timeout),this._timeout=void 0),this._timeBase+=Date.now()-this._restartTime,this._setStatus("paused"))}},{key:"resume",value:function(e){"paused"===this._status&&(e&&(this.interval=e),this._timeout=setInterval(this._tick,this._interval),this._restartTime=Date.now())}},{key:"_setStatus",value:function(e){if(e!==this._status){var t=this._status;this._status=e,this.emit("status-change",{status:e,prevStatus:t})}}},{key:"interval",get:function(){return this._interval},set:function(e){e<=0||(this._interval=e,void 0!==this._timeout&&(clearInterval(this._timeout),this._timeout=setInterval(this._tick,this._interval)))}},{key:"maxTime",get:function(){return this._maxTime},set:function(e){"number"===typeof e&&e<=this._interval||(this._maxTime=e)}},{key:"time",get:function(){return this._time}},{key:"timeFlags",get:function(){return Object(r.a)(this._timeFlags)}},{key:"startTime",get:function(){return this._startTime}},{key:"restartTime",get:function(){return this._restartTime}},{key:"status",get:function(){return this._status}}]),t}(a(13).a),I=Object(p.a)({back:"\u2b1c",blank:"\u25fb\ufe0f",mark:"\ud83d\udea9",bomb:"\ud83d\udca3",boom:"\ud83d\udca5",ongoing:"\ud83d\ude00",completed:"\ud83d\ude0e",failed:"\ud83d\ude35",frightened:"\ud83d\ude2c",hovered:"\ud83d\ude36",rowNum:10,colNum:10,bombNum:10}),H=Object(p.b)(I),R=function(e){function t(e){var a;Object(u.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).stopwatch=void 0,a.handleHeaderClick=function(){var e=a.innerProps,t=e.rowNum,n=e.colNum,o=e.bombNum;a.setState(Object(c.a)({},b(t,n,o))),a.stopwatch.stop()},a.handleBlockSpread=function(e){e.isFlipped=!0,a.setState((function(e){return Object(c.a)({},e,{flippedNum:e.flippedNum+1})})),e.isMarked&&(e.isMarked=!1,a.setState((function(e){return Object(c.a)({},e,{markedNum:e.markedNum-1})})))},a.handleStopwatchTick=function(e){a.setState({time:e.time})},a.handleBlockMouseUp=function(e,t,n){if(0===n.button){var o,i=a.state,s=i.rowNum,u=i.colNum,l=i.bombNum,m=i.totalNum,d=i.status,h=i.stepNum;a.state.blockMap?o=a.state.blockMap:(o=v({rowNum:s,colNum:u,bombNum:l,totalNum:m,seedRow:e,seedCol:t}),a.setState({blockMap:o}),a.stopwatch.start());var p=o[e*u+t];if("ongoing"===d&&!p.isFlipped&&!p.isMarked){if(a.setState({isFrightened:!1,stepNum:h+1}),-1===p.type)return p.type=-2,a.setState({status:"failed"}),void a.stopwatch.stop();!function e(t){var a=t.rowNum,n=t.colNum,o=t.blockMap,i=t.row,s=t.col,r=t.handler,u=o[i*n+s];u.isFlipped||-1===u.type||(r(u),0===u.type&&(i>0&&s>0&&e(Object(c.a)({},t,{row:i-1,col:s-1})),i>0&&e(Object(c.a)({},t,{row:i-1,col:s})),i>0&&s<n-1&&e(Object(c.a)({},t,{row:i-1,col:s+1})),s>0&&e(Object(c.a)({},t,{row:i,col:s-1})),s<n-1&&e(Object(c.a)({},t,{row:i,col:s+1})),i<a-1&&s>0&&e(Object(c.a)({},t,{row:i+1,col:s-1})),i<a-1&&e(Object(c.a)({},t,{row:i+1,col:s})),i<a-1&&s<n-1&&e(Object(c.a)({},t,{row:i+1,col:s+1}))))}({rowNum:s,colNum:u,blockMap:o,row:e,col:t,handler:a.handleBlockSpread}),a.setState((function(e){return Object(c.a)({},e,{blockMap:Object(r.a)(o)})}))}}},a.handleBlockContextMenu=function(e,t,n){var o=a.state,i=o.colNum,s=o.blockMap,c=o.markedNum,u=o.status;if(s){var l=s[e*i+t];"ongoing"!==u||l.isFlipped||(l.isMarked=!l.isMarked,a.setState({markedNum:c+(l.isMarked?1:-1),blockMap:Object(r.a)(s),isFrightened:!1}))}},a.handleBlockMouseEnter=function(e,t,n){var o=a.state,i=o.colNum,s=o.blockMap;if(s){var r=s[e*i+t];r.isFlipped||r.isMarked||a.setState({isFrightened:!0})}else a.setState({isFrightened:!0})},a.handleBlockMouseLeave=function(e,t,n){a.setState({isFrightened:!1})};var n=a.innerProps,o=n.rowNum,i=n.colNum,s=n.bombNum;return a.state=Object(c.a)({},b(o,i,s),{isFrightened:!1}),a.stopwatch=new D,a.stopwatch.on("tick",a.handleStopwatchTick),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){var a=this.innerProps,n=a.rowNum,o=a.colNum,i=a.bombNum,s=H(e),r=s.rowNum,u=s.colNum,l=s.bombNum;n===r&&o===u&&i===l?"ongoing"===this.state.status&&this.state.flippedNum===this.state.totalNum-this.state.bombNum&&(this.setState({status:"completed"}),this.stopwatch.stop()):this.setState(Object(c.a)({},b(n,o,i)))}},{key:"renderHeader",value:function(){var e=this.state,t=e.status,a=e.isFrightened,n=this.innerProps,i=n.ongoing,s=n.completed,r=n.failed,c=n.frightened,u=n.hovered;return o.a.createElement(M,{classBlock:"minesweeper",ongoing:i,completed:s,failed:r,frightened:c,hovered:u,status:t,isFrightened:a,onClick:this.handleHeaderClick})}},{key:"renderGrid",value:function(){var e=this.innerProps,t=this.state,a=t.rowNum,n=t.colNum,i=t.blockMap,s=t.status,r={classBlock:"minesweeper",back:e.back,blank:e.blank,mark:e.mark,bomb:e.bomb,boom:e.boom,rowNum:a,colNum:n,blockMap:i,status:s};return o.a.createElement(L,Object.assign({},r,{onMouseUp:this.handleBlockMouseUp,onContextMenu:this.handleBlockContextMenu,onMouseEnter:this.handleBlockMouseEnter,onMouseLeave:this.handleBlockMouseLeave}))}},{key:"renderFooter",value:function(){var e=this.state,t=e.markedNum,a=e.stepNum,n=e.time,i=this.innerProps.bombNum;return o.a.createElement("div",{className:"".concat("minesweeper","__footer")},o.a.createElement("div",{className:"".concat("minesweeper","__bomb-counter")},o.a.createElement("span",null,i-t," / ",i),o.a.createElement("span",null,"BOMBS")),o.a.createElement("div",{className:"".concat("minesweeper","__step-counter")},o.a.createElement("span",null,a),o.a.createElement("span",null,"STEPS")),o.a.createElement("div",{className:"".concat("minesweeper","__time-counter")},o.a.createElement("span",null,(n/1e3).toFixed(3)),o.a.createElement("span",null,"TIME")))}},{key:"render",value:function(){return o.a.createElement("div",{className:"".concat("minesweeper"),onContextMenu:function(e){return e.preventDefault()}},this.renderHeader(),this.renderGrid(),this.renderFooter())}},{key:"innerProps",get:function(){return H(this.props)}}]),t}(n.Component);R.defaultProps=I;a(23);var G=R,J=function(){return o.a.createElement("div",{className:"app"},o.a.createElement(G,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(J,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[15,1,2]]]);
//# sourceMappingURL=main.e33dd9f2.chunk.js.map